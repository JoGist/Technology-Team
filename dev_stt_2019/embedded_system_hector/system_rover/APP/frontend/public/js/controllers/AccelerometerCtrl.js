/* global devstudyAPP */
'use strict';

devstudyAPP.controller('AccelerometerController',
    function($scope, $http, $interval) {
      var url = 'http://api.devstudy.com/';
      $scope.gyroscope = {
          roll:'0',
          pitch:'0',
          yaw:'0'
      }
      $scope.fusionPose = {};


        $scope.options = {
            margin: {
                top: 5
            },
            series: [
                {
                    axis: "y",
                    dataset: "dataset0",
                    key: "val_0",
                    label: "A line series",
                    color: "hsla(88, 48%, 48%, 1)",
                    type: [
                      "line"
                    ],
                    id: "mySeries0"
                }
            ],
            axes: {
                x: {
                    key: "x"
                },
                y: {
                    key: "y",
                    max:2,
                    min:-2
                },
            }
        };
        $scope.datax = {
          dataset0: [
              {x: 0, val_0: 0, val_1: 0, val_2: 0, val_3: 0},
              {x: 0, val_0: 0, val_1: 3.894, val_2: 8.47, val_3: 14.347},
              {x: 0, val_0: 0, val_1: 7.174, val_2: 13.981, val_3: 19.991},
              {x: 0, val_0: 0, val_1: 9.32, val_2: 14.608, val_3: 13.509},
              {x: 0, val_0: 0, val_1: 9.996, val_2: 10.132, val_3: -1.167},
              {x: 0, val_0: 0, val_1: 9.093, val_2: 2.117, val_3: -15.136},
              {x: 0, val_0: 0, val_1: 6.755, val_2: -6.638, val_3: -19.923},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625}
          ]
        };
        $scope.datay = {
          dataset0: [
              {x: 0, val_0: 0, val_1: 0, val_2: 0, val_3: 0},
              {x: 0, val_0: 0, val_1: 3.894, val_2: 8.47, val_3: 14.347},
              {x: 0, val_0: 0, val_1: 7.174, val_2: 13.981, val_3: 19.991},
              {x: 0, val_0: 0, val_1: 9.32, val_2: 14.608, val_3: 13.509},
              {x: 0, val_0: 0, val_1: 9.996, val_2: 10.132, val_3: -1.167},
              {x: 0, val_0: 0, val_1: 9.093, val_2: 2.117, val_3: -15.136},
              {x: 0, val_0: 0, val_1: 6.755, val_2: -6.638, val_3: -19.923},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625}
          ]
        };
        $scope.dataz = {
          dataset0: [
              {x: 0, val_0: 0, val_1: 0, val_2: 0, val_3: 0},
              {x: 0, val_0: 0, val_1: 3.894, val_2: 8.47, val_3: 14.347},
              {x: 0, val_0: 0, val_1: 7.174, val_2: 13.981, val_3: 19.991},
              {x: 0, val_0: 0, val_1: 9.32, val_2: 14.608, val_3: 13.509},
              {x: 0, val_0: 0, val_1: 9.996, val_2: 10.132, val_3: -1.167},
              {x: 0, val_0: 0, val_1: 9.093, val_2: 2.117, val_3: -15.136},
              {x: 0, val_0: 0, val_1: 6.755, val_2: -6.638, val_3: -19.923},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625},
              {x: 0, val_0: 0, val_1: 3.35, val_2: -13.074, val_3: -12.625}
          ]
        };
        var x = 0;
        var setData = function(array, value) {
            var time = new Date();
            array.dataset0.shift();
            x = x+1;
            var data = {x: x, val_0: value, val_1: 7.174, val_2: 13.981, val_3: 19.991};
            array.dataset0.push(data);
        };

        var callParams = {
            url: url+"Imu",
            method: 'GET',
            params: {color:'green'}
        };
        $interval(function(){
            $http(callParams)
             .success(function(data, status, headers, config) {
               //  console.log('Sucees: ',data.result);
                $scope.imuData = data.result;
                console.log($scope.imuData.accel);
                $scope.gyroscope.roll = parseFloat($scope.imuData.accel[0]);
                $scope.gyroscope.pitch = parseFloat($scope.imuData.accel[1]);
                $scope.gyroscope.yaw = parseFloat($scope.imuData.accel[2]);

                // $scope.fusionPose.roll = Math.degrees($scope.imuData.fusionPose[0]);
                // $scope.fusionPose.pitch = Math.degrees($scope.imuData.fusionPose[1]);
                // $scope.fusionPose.yaw = Math.degrees($scope.imuData.fusionPose[2]);
                $scope.fusionPose.roll = $scope.gyroscope.roll;
                $scope.fusionPose.pitch = $scope.gyroscope.pitch;
                $scope.fusionPose.yaw = $scope.gyroscope.yaw;

                // $scope.figureStyle1={
                //      'transform':' rotateX( '+$scope.fusionPose.roll*-1+'deg ) ' + 'rotateY( '+$scope.fusionPose.pitch*-1+'deg ) ' + 'rotateZ( '+$scope.fusionPose.yaw+'deg )'
                // };
                $scope.figureStyle1={
                     'transform':' rotateZ( '+$scope.fusionPose.roll+'deg ) '
                };
                $scope.figureStyle2={
                     'transform': 'rotateZ( '+$scope.fusionPose.pitch+'deg ) '
                };
                $scope.figureStyle3={
                     'transform': 'rotateZ( '+$scope.fusionPose.yaw+'deg )'
                };
                setData($scope.datax, $scope.fusionPose.roll);
                setData($scope.datay, $scope.fusionPose.pitch);
                setData($scope.dataz, $scope.fusionPose.yaw);
             }).error(function(data, status, headers, config) {
                // console.log('Error: ',data);
                // console.log('Status: ',data);
             });
        }, 1000);



        // $scope.data = {
        //     timed: [
        //         {
        //           x: "2016-03-03T11:29:47.892Z",
        //           val_0: 0,
        //           val_1: 0,
        //           val_2: 0,
        //           val_3: 0
        //         },
        //         {
        //           x: "2016-03-04T11:29:47.892Z",
        //           val_0: 0.993,
        //           val_1: 3.894,
        //           val_2: 8.47,
        //           val_3: 14.347
        //         },
        //         {
        //           x: "2016-03-05T11:29:47.892Z",
        //           val_0: 1.947,
        //           val_1: 7.174,
        //           val_2: 13.981,
        //           val_3: 19.991
        //         },
        //         {
        //           x: "2016-03-06T11:29:47.892Z",
        //           val_0: 2.823,
        //           val_1: 9.32,
        //           val_2: 14.608,
        //           val_3: 13.509
        //         },
        //         {
        //           x: "2016-03-07T11:29:47.892Z",
        //           val_0: 3.587,
        //           val_1: 9.996,
        //           val_2: 10.132,
        //           val_3: -1.167
        //         },
        //         {
        //           x: "2016-03-08T11:29:47.892Z",
        //           val_0: 4.207,
        //           val_1: 9.093,
        //           val_2: 2.117,
        //           val_3: -15.136
        //         },
        //         {
        //           x: "2016-03-09T11:29:47.892Z",
        //           val_0: 4.66,
        //           val_1: 6.755,
        //           val_2: -6.638,
        //           val_3: -19.923
        //         },
        //         {
        //           x: "2016-03-10T11:29:47.892Z",
        //           val_0: 4.927,
        //           val_1: 3.35,
        //           val_2: -13.074,
        //           val_3: -12.625
        //         },
        //         {
        //           x: "2016-03-11T11:29:47.892Z",
        //           val_0: 4.998,
        //           val_1: -0.584,
        //           val_2: -14.942,
        //           val_3: 2.331
        //         },
        //         {
        //           x: "2016-03-12T11:29:47.892Z",
        //           val_0: 4.869,
        //           val_1: -4.425,
        //           val_2: -11.591,
        //           val_3: 15.873
        //         }
        //     ],
        //     tolerance: [
        //         {
        //           x: 0,
        //           average: 24,
        //           extrema_min: 19,
        //           extrema_max: 29
        //         },
        //         {
        //           x: 1,
        //           average: 24,
        //           extrema_min: 19,
        //           extrema_max: 29
        //         },
        //         {
        //           x: 2,
        //           average: 21,
        //           extrema_min: 16,
        //           extrema_max: 23
        //         },
        //         {
        //           x: 3,
        //           average: 24,
        //           extrema_min: 21,
        //           extrema_max: 29
        //         },
        //         {
        //           x: 4,
        //           average: 22,
        //           extrema_min: 18,
        //           extrema_max: 26
        //         },
        //         {
        //           x: 5,
        //           average: 21,
        //           extrema_min: 18,
        //           extrema_max: 26
        //         },
        //         {
        //           x: 6,
        //           average: 23,
        //           extrema_min: 19,
        //           extrema_max: 27
        //         },
        //         {
        //           x: 7,
        //           average: 24,
        //           extrema_min: 20,
        //           extrema_max: 29
        //         },
        //         {
        //           x: 8,
        //           average: 22,
        //           extrema_min: 18,
        //           extrema_max: 26
        //         },
        //         {
        //           x: 9,
        //           average: 23,
        //           extrema_min: 20,
        //           extrema_max: 26
        //         }
        //     ],
        //     numerical: [
        //         {
        //           x: 0,
        //           val_0: 0,
        //           val_1: 0,
        //           val_2: 0,
        //           val_3: 0
        //         },
        //         {
        //           x: 1,
        //           val_0: 0.993,
        //           val_1: 3.894,
        //           val_2: 8.47,
        //           val_3: 14.347
        //         },
        //         {
        //           x: 2,
        //           val_0: 1.947,
        //           val_1: 7.174,
        //           val_2: 13.981,
        //           val_3: 19.991
        //         },
        //         {
        //           x: 3,
        //           val_0: 2.823,
        //           val_1: 9.32,
        //           val_2: 14.608,
        //           val_3: 13.509
        //         },
        //         {
        //           x: 4,
        //           val_0: 3.587,
        //           val_1: 9.996,
        //           val_2: 10.132,
        //           val_3: -1.167
        //         },
        //         {
        //           x: 5,
        //           val_0: 4.207,
        //           val_1: 9.093,
        //           val_2: 2.117,
        //           val_3: -15.136
        //         },
        //         {
        //           x: 6,
        //           val_0: 4.66,
        //           val_1: 6.755,
        //           val_2: -6.638,
        //           val_3: -19.923
        //         },
        //         {
        //           x: 7,
        //           val_0: 4.927,
        //           val_1: 3.35,
        //           val_2: -13.074,
        //           val_3: -12.625
        //         },
        //         {
        //           x: 8,
        //           val_0: 4.998,
        //           val_1: -0.584,
        //           val_2: -14.942,
        //           val_3: 2.331
        //         },
        //         {
        //           x: 9,
        //           val_0: 4.869,
        //           val_1: -4.425,
        //           val_2: -11.591,
        //           val_3: 15.873
        //         }
        //     ],
        //     logarithmic: [
        //         {
        //           x: 0,
        //           val_0: 300000,
        //           val_1: 400000,
        //           val_2: 500000,
        //           val_3: 600000
        //         },
        //         {
        //           x: 1,
        //           val_0: 208060,
        //           val_1: 308060,
        //           val_2: 408060,
        //           val_3: 508060
        //         },
        //         {
        //           x: 2,
        //           val_0: 16771,
        //           val_1: 116771,
        //           val_2: 216771,
        //           val_3: 316771
        //         },
        //         {
        //           x: 3,
        //           val_0: 97998,
        //           val_1: 2002,
        //           val_2: 102002,
        //           val_3: 202002
        //         },
        //         {
        //           x: 4,
        //           val_0: 30728,
        //           val_1: 69272,
        //           val_2: 169272,
        //           val_3: 269272
        //         },
        //         {
        //           x: 5,
        //           val_0: 156732,
        //           val_1: 256732,
        //           val_2: 356732,
        //           val_3: 456732
        //         },
        //         {
        //           x: 6,
        //           val_0: 292034,
        //           val_1: 392034,
        //           val_2: 492034,
        //           val_3: 592034
        //         },
        //         {
        //           x: 7,
        //           val_0: 250780,
        //           val_1: 350780,
        //           val_2: 450780,
        //           val_3: 550780
        //         },
        //         {
        //           x: 8,
        //           val_0: 70900,
        //           val_1: 170900,
        //           val_2: 270900,
        //           val_3: 370900
        //         },
        //         {
        //           x: 9,
        //           val_0: 82226,
        //           val_1: 17774,
        //           val_2: 117774,
        //           val_3: 217774
        //         }
        //     ],
        //     noisy: [
        //         {
        //           x: 0,
        //           val_0: 41,
        //           val_1: 43,
        //           val_2: 59,
        //           val_3: 15
        //         },
        //         {
        //           x: 1,
        //           val_0: 20,
        //           val_1: 79,
        //           val_2: 81,
        //           val_3: 11
        //         },
        //         {
        //           x: 2,
        //           val_0: 39,
        //           val_1: 72,
        //           val_2: 69,
        //           val_3: 92
        //         },
        //         {
        //           x: 3,
        //           val_0: 39,
        //           val_1: 100,
        //           val_2: 47,
        //           val_3: 67
        //         },
        //         {
        //           x: 4,
        //           val_0: 3,
        //           val_1: 71,
        //           val_2: 23,
        //           val_3: 22
        //         },
        //         {
        //           x: 5,
        //           val_0: 66,
        //           val_1: 43,
        //           val_2: 77,
        //           val_3: 86
        //         },
        //         {
        //           x: 6,
        //           val_0: 4,
        //           val_1: 27,
        //           val_2: 23,
        //           val_3: 35
        //         },
        //         {
        //           x: 7,
        //           val_0: 67,
        //           val_1: 87,
        //           val_2: 42,
        //           val_3: 65
        //         },
        //         {
        //           x: 8,
        //           val_0: 58,
        //           val_1: 3,
        //           val_2: 90,
        //           val_3: 76
        //         },
        //         {
        //           x: 9,
        //           val_0: 77,
        //           val_1: 6,
        //           val_2: 85,
        //           val_3: 56
        //         }
        //     ],
        //     interrupted: [
        //         {
        //           x: 0,
        //           val_0: 0,
        //           val_1: 0,
        //           val_2: 0,
        //           val_3: 0
        //         },
        //         {
        //           x: 1,
        //           val_0: 0.993,
        //           val_1: 3.894,
        //           val_2: 8.47,
        //           val_3: 14.347
        //         },
        //         {
        //           x: 2,
        //           val_0: 1.947,
        //           val_1: 7.174,
        //           val_2: 13.981,
        //           val_3: 19.991
        //         },
        //         {
        //           x: 3,
        //           val_0: 2.823,
        //           val_1: 9.32,
        //           val_2: 14.608,
        //           val_3: 13.509
        //         },
        //         {
        //           x: 4,
        //           val_0: 3.587,
        //           val_1: 9.996,
        //           val_2: 10.132,
        //           val_3: 1.167
        //         },
        //         {
        //           x: 5,
        //           val_0: 4.207,
        //           val_1: 9.093,
        //           val_2: 2.117,
        //           val_3: 15.136
        //         },
        //         {
        //           x: 6,
        //           val_0: 4.66,
        //           val_1: 6.755,
        //           val_2: 6.638,
        //           val_3: 19.923
        //         },
        //         {
        //           x: 7,
        //           val_0: 4.927,
        //           val_1: 3.35,
        //           val_2: 13.074
        //         },
        //         {
        //           x: 8,
        //           val_0: 4.998,
        //           val_1: 0.584
        //         },
        //         {
        //           x: 9,
        //           val_0: 4.869
        //         }
        //     ],
        //     parametric: [
        //         {
        //           x: 2,
        //           y: 0
        //         },
        //         {
        //           x: 1.9138806714644176,
        //           y: 0.9427934736519953
        //         },
        //         {
        //           x: 1.6629392246050905,
        //           y: 1.6629392246050905
        //         },
        //         {
        //           x: 1.268786568327291,
        //           y: 1.9903694533443936
        //         },
        //         {
        //           x: 0.7653668647301797,
        //           y: 1.8477590650225735
        //         },
        //         {
        //           x: 0.19603428065912154,
        //           y: 1.268786568327291
        //         },
        //         {
        //           x: -0.3901806440322564,
        //           y: 0.3901806440322572
        //         },
        //         {
        //           x: -0.9427934736519954,
        //           y: -0.5805693545089242
        //         },
        //         {
        //           x: -1.414213562373095,
        //           y: -1.414213562373095
        //         },
        //         {
        //           x: -1.7638425286967099,
        //           y: -1.9138806714644176
        //         },
        //         {
        //           x: -1.9615705608064609,
        //           y: -1.9615705608064609
        //         },
        //         {
        //           x: -1.9903694533443939,
        //           y: -1.5460209067254749
        //         },
        //         {
        //           x: -1.8477590650225737,
        //           y: -0.7653668647301808
        //         },
        //         {
        //           x: -1.5460209067254738,
        //           y: 0.19603428065912182
        //         },
        //         {
        //           x: -1.1111404660392044,
        //           y: 1.1111404660392066
        //         },
        //         {
        //           x: -0.5805693545089231,
        //           y: 1.7638425286967114
        //         },
        //         {
        //           x: 3.185319639056295e-15,
        //           y: 2
        //         },
        //         {
        //           x: 0.5805693545089275,
        //           y: 1.763842528696707
        //         },
        //         {
        //           x: 1.1111404660392066,
        //           y: 1.1111404660391988
        //         },
        //         {
        //           x: 1.5460209067254764,
        //           y: 0.19603428065911419
        //         },
        //         {
        //           x: 1.8477590650225757,
        //           y: -0.7653668647301862
        //         },
        //         {
        //           x: 1.9903694533443943,
        //           y: -1.5460209067254786
        //         },
        //         {
        //           x: 1.96157056080646,
        //           y: -1.961570560806463
        //         },
        //         {
        //           x: 1.7638425286967068,
        //           y: -1.9138806714644145
        //         },
        //         {
        //           x: 1.4142135623730892,
        //           y: -1.414213562373087
        //         },
        //         {
        //           x: 0.9427934736519882,
        //           y: -0.5805693545089101
        //         },
        //         {
        //           x: 0.39018064403224884,
        //           y: 0.39018064403227165
        //         },
        //         {
        //           x: -0.19603428065913053,
        //           y: 1.268786568327303
        //         },
        //         {
        //           x: -0.7653668647301897,
        //           y: 1.8477590650225795
        //         },
        //         {
        //           x: -1.2687865683273005,
        //           y: 1.9903694533443923
        //         },
        //         {
        //           x: -1.6629392246050962,
        //           y: 1.6629392246050796
        //         },
        //         {
        //           x: -1.9138806714644212,
        //           y: 0.9427934736519777
        //         },
        //         {
        //           x: -2,
        //           y: -2.009163527365565e-14
        //         },
        //         {
        //           x: -1.9138806714644143,
        //           y: -0.9427934736520163
        //         },
        //         {
        //           x: -1.6629392246050831,
        //           y: -1.6629392246051018
        //         },
        //         {
        //           x: -1.2687865683272799,
        //           y: -1.990369453344396
        //         },
        //         {
        //           x: -0.7653668647301647,
        //           y: -1.8477590650225628
        //         },
        //         {
        //           x: -0.19603428065910372,
        //           y: -1.268786568327272
        //         },
        //         {
        //           x: 0.3901806440322718,
        //           y: -0.3901806440322288
        //         },
        //         {
        //           x: 0.9427934736520104,
        //           y: 0.5805693545089554
        //         },
        //         {
        //           x: 1.4142135623731082,
        //           y: 1.4142135623731154
        //         },
        //         {
        //           x: 1.7638425286967179,
        //           y: 1.9138806714644272
        //         },
        //         {
        //           x: 1.9615705608064637,
        //           y: 1.9615705608064553
        //         },
        //         {
        //           x: 1.9903694533443925,
        //           y: 1.5460209067254576
        //         },
        //         {
        //           x: 1.8477590650225695,
        //           y: 0.7653668647301589
        //         },
        //         {
        //           x: 1.5460209067254684,
        //           y: -0.19603428065914005
        //         },
        //         {
        //           x: 1.111140466039199,
        //           y: -1.1111404660392175
        //         },
        //         {
        //           x: 0.5805693545089204,
        //           y: -1.7638425286967159
        //         },
        //         {
        //           x: -2.450531559567883e-15,
        //           y: -2
        //         },
        //         {
        //           x: -0.5805693545089251,
        //           y: -1.7638425286967074
        //         },
        //         {
        //           x: -1.111140466039203,
        //           y: -1.1111404660392028
        //         },
        //         {
        //           x: -1.5460209067254715,
        //           y: -0.19603428065912248
        //         },
        //         {
        //           x: -1.8477590650225713,
        //           y: 0.7653668647301752
        //         },
        //         {
        //           x: -1.990369453344393,
        //           y: 1.5460209067254689
        //         },
        //         {
        //           x: -1.9615705608064629,
        //           y: 1.9615705608064586
        //         },
        //         {
        //           x: -1.7638425286967157,
        //           y: 1.913880671464422
        //         },
        //         {
        //           x: -1.4142135623731047,
        //           y: 1.4142135623731078
        //         },
        //         {
        //           x: -0.9427934736520092,
        //           y: 0.5805693545089453
        //         },
        //         {
        //           x: -0.390180644032274,
        //           y: -0.3901806440322321
        //         },
        //         {
        //           x: 0.19603428065910153,
        //           y: -1.2687865683272692
        //         },
        //         {
        //           x: 0.7653668647301594,
        //           y: -1.8477590650225615
        //         },
        //         {
        //           x: 1.2687865683272725,
        //           y: -1.9903694533443972
        //         },
        //         {
        //           x: 1.662939224605076,
        //           y: -1.6629392246051118
        //         },
        //         {
        //           x: 1.9138806714644097,
        //           y: -0.942793473652032
        //         },
        //         {
        //           x: 2,
        //           y: -4.508185774390072e-14
        //         }
        //     ]
        // };

    }
);
